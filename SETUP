#!/bin/bash
# TODO: Replace with proper build system!

echo "Before continuing, make sure that you have the following programs installed:"
echo "+ ghc"
echo "+ cabal-install"
echo "+ clang"
echo "+ git"
echo "+ make"
read -p "Press any key to continue..."

SRC=$(pwd)
GC="8.0.4"

# Get Blocks Runtime
git clone https://github.com/mackyle/blocksruntime $SRC/blocksruntime
cd $SRC/blocksruntime

# Build Blocks Runtime
CC=clang ./buildlib

# Install Blocks Runtime
sudo ./installlib
cd $SRC

# Get Boehm
wget https://www.hboehm.info/gc/gc_source/gc-$GC.tar.gz
tar xvfz gc-$GC.tar.gz
cd $SRC/gc-$GC
./configure --prefix=$SRC/gc --disable-threads
make
make install
cd $SRC

# Install Split
cabal update
cabal new-install split --lib
