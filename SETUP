#!/usr/bin/env bash
# TODO: Replace with proper build system!

echo "This install script was written for Linux, not MacOS. If you are on MacOS, this probably won't work!"
echo "Before continuing, make sure that you have the following programs installed:"
echo "+ ghc"
echo "+ cabal-install"
echo "+ clang"
echo "+ git"
echo "+ make"
echo "+ autoconf"
echo "+ libtool"
echo "+ tar"
echo "+ wget"
read -p "Press any key to continue..."

SRC=$(pwd)
TMPDIR="/tmp/cognac-setup"

mkdir -p $TMPDIR

# Blocks Runtime for lexical closures
cd $TMPDIR
git clone https://github.com/mackyle/blocksruntime
cd blocksruntime
CC=clang ./buildlib
sudo ./installlib

# Boehm garbage collector
cd $TMPDIR
git clone git://github.com/ivmai/bdwgc.git
cd bdwgc
git clone git://github.com/ivmai/libatomic_ops.git
./autogen.sh
./configure --prefix=/usr --disable-threads
make -j
sudo make install


# Split (haskell string lib)
cd $SRC
cabal update
cabal new-install split --lib # For new versions of cabal
cabal install split           # For old versions of cabal
